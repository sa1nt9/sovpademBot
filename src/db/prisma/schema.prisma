generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id             String       @id // Уникальный ID
    name           String
    city           String
    longitude      Float
    latitude       Float
    gender         Gender
    interestedIn   InterestedIn
    age            Int
    text           String
    files          Json // Массив файлов в JSON
    ownCoordinates Boolean? // Может быть null
    createdAt      DateTime     @default(now()) // Дата создания
    isActive       Boolean      @default(true) // Активна ли анкета

    likesGiven    UserLike[] @relation(name: "UserLikesTarget")
    likesReceived UserLike[] @relation(name: "TargetLikedByUser")
}

model UserLike {
    id        String   @id @default(uuid())
    userId    String // Кто лайкнул
    targetId  String // Кого лайкнули
    liked     Boolean // true — лайк, false — дизлайк
    message   String? // Текстовое сообщение к лайку
    videoFileId String? // ID файла видео, если было отправлено
    createdAt DateTime @default(now())

    user   User @relation(name: "UserLikesTarget", fields: [userId], references: [id])
    target User @relation(name: "TargetLikedByUser", fields: [targetId], references: [id])
}

model Session {
  id    Int    @id @default(autoincrement())
  key   String @unique
  value String
}

enum Gender {
    male
    female
}

enum InterestedIn {
    male
    female
    all
}
