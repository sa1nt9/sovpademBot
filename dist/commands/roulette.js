"use strict";var __awaiter=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(s,n){function i(e){try{u(r.next(e))}catch(e){n(e)}}function a(e){try{u(r.throw(e))}catch(e){n(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.rouletteCommand=void 0;const keyboards_1=require("../constants/keyboards"),postgres_1=require("../db/postgres"),roulette_start_1=require("../messages/roulette_start"),rouletteCommand=e=>__awaiter(void 0,void 0,void 0,(function*(){var t;const o=String(null===(t=e.message)||void 0===t?void 0:t.from.id);e.logger.info({userId:o},"Starting roulette command");(yield postgres_1.prisma.user.findUnique({where:{id:o}}))?(e.logger.info({userId:o},"Showing roulette start menu"),e.session.step="roulette_start",yield(0,roulette_start_1.showRouletteStart)(e)):(e.session.step="you_dont_have_form",e.logger.warn({userId:o},"User tried to start roulette without profile"),yield e.reply(e.t("you_dont_have_form"),{reply_markup:(0,keyboards_1.notHaveFormToDeactiveKeyboard)(e.t)}))}));exports.rouletteCommand=rouletteCommand;