"use strict";var __awaiter=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(i,a){function s(e){try{d(r.next(e))}catch(e){a(e)}}function n(e){try{d(r.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,n)}d((r=r.apply(e,t||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.deactivateCommand=void 0;const keyboards_1=require("../constants/keyboards"),postgres_1=require("../db/postgres"),profilesService_1=require("../functions/db/profilesService"),deactivateCommand=e=>__awaiter(void 0,void 0,void 0,(function*(){var t;const o=String(null===(t=e.message)||void 0===t?void 0:t.from.id);e.logger.info({userId:o},"Starting deactivate command");if(yield postgres_1.prisma.user.findUnique({where:{id:o}})){e.session.step="disable_form",e.logger.info({userId:o},"Getting user profiles for deactivation");const t=yield(0,profilesService_1.getUserProfiles)(o,e);yield e.reply(e.t("are_you_sure_you_want_to_disable_your_form"),{reply_markup:(0,keyboards_1.deactivateProfileKeyboard)(e.t,t)})}else e.session.step="you_dont_have_form",e.logger.warn({userId:o},"User tried to deactivate without profile"),yield e.reply(e.t("you_dont_have_form"),{reply_markup:(0,keyboards_1.notHaveFormToDeactiveKeyboard)(e.t)})}));exports.deactivateCommand=deactivateCommand;