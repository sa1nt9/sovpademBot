"use strict";var __awaiter=this&&this.__awaiter||function(e,r,t,a){return new(t||(t=Promise))((function(i,s){function l(e){try{o(a.next(e))}catch(e){s(e)}}function n(e){try{o(a.throw(e))}catch(e){s(e)}}function o(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(l,n)}o((a=a.apply(e,r||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.revealRejectCallbackQuery=void 0;const postgres_1=require("../db/postgres"),i18n_1=require("../i18n"),logger_1=require("../logger"),revealRejectCallbackQuery=e=>__awaiter(void 0,void 0,void 0,(function*(){var r;logger_1.logger.info({userId:null===(r=e.from)||void 0===r?void 0:r.id},"User rejected reveal request");const t=e.callbackQuery,a=t.data.split(":")[1];yield e.answerCallbackQuery({text:e.t("roulette_reveal_rejected"),show_alert:!1}),t.message&&(yield e.api.editMessageText(t.message.chat.id,t.message.message_id,e.t("roulette_reveal_rejected"),{reply_markup:{inline_keyboard:[]}}));const i=yield postgres_1.prisma.session.findUnique({where:{key:a}}),{__language_code:s}=i?JSON.parse(i.value):{};yield e.api.sendMessage(a,(0,i18n_1.i18n)(!1).t(s||"ru","roulette_reveal_rejected_message"))}));exports.revealRejectCallbackQuery=revealRejectCallbackQuery;