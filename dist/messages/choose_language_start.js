"use strict";var __awaiter=this&&this.__awaiter||function(e,a,t,n){return new(t||(t=Promise))((function(r,s){function o(e){try{g(n.next(e))}catch(e){s(e)}}function i(e){try{g(n.throw(e))}catch(e){s(e)}}function g(e){var a;e.done?r(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(o,i)}g((n=n.apply(e,a||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.chooseLanguageStartStep=chooseLanguageStartStep;const languages_1=require("../constants/languages"),keyboards_1=require("../constants/keyboards");function chooseLanguageStartStep(e){return __awaiter(this,void 0,void 0,(function*(){const a=e.message.text,t=languages_1.languages.find((e=>e.name===a)),n=String(e.from.id);e.logger.info({userId:n,step:"choose_language_start",selectedLanguage:a},"User selecting initial language"),t?(e.logger.info({userId:n,languageCode:t.mark},"Initial language selected successfully"),yield e.i18n.setLocale(t.mark||"ru"),e.session.step="prepare_message",yield e.reply(e.t("lets_start"),{reply_markup:(0,keyboards_1.prepareMessageKeyboard)(e.t)})):(e.logger.warn({userId:n,invalidLanguage:a},"User selected invalid initial language option"),yield e.reply(e.t("no_such_answer"),{reply_markup:keyboards_1.languageKeyboard}))}))}