"use strict";var __awaiter=this&&this.__awaiter||function(e,n,t,i){return new(t||(t=Promise))((function(r,o){function d(e){try{s(i.next(e))}catch(e){o(e)}}function a(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(d,a)}s((i=i.apply(e,n||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.continueSeeFormsStep=continueSeeFormsStep;const candidatesEnded_1=require("../functions/candidatesEnded"),getCandidate_1=require("../functions/db/getCandidate"),sendForm_1=require("../functions/sendForm"),startSearchingPeople_1=require("../functions/startSearchingPeople");function continueSeeFormsStep(e){return __awaiter(this,void 0,void 0,(function*(){const n=String(e.from.id);e.logger.info({userId:n,step:"continue_see_forms"},"User continuing to browse profiles"),yield(0,startSearchingPeople_1.startSearchingPeople)(e,{setActive:!0});const t=yield(0,getCandidate_1.getCandidate)(e);e.logger.info({userId:n,candidateId:null==t?void 0:t.id},"Retrieved next candidate for user"),t?yield(0,sendForm_1.sendForm)(e,t||null,{myForm:!1}):(e.logger.info({userId:n},"No more candidates available"),yield(0,candidatesEnded_1.candidatesEnded)(e))}))}