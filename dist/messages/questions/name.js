"use strict";var __awaiter=this&&this.__awaiter||function(e,n,o,s){return new(o||(o=Promise))((function(t,i){function r(e){try{l(s.next(e))}catch(e){i(e)}}function a(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,a)}l((s=s.apply(e,n||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.nameQuestion=void 0;const keyboards_1=require("../../constants/keyboards"),nameQuestion=e=>__awaiter(void 0,void 0,void 0,(function*(){var n;const o=e.message.text,s=String(e.from.id);e.logger.info({userId:s,question:"name",input:o,profileType:null===(n=e.session.activeProfile)||void 0===n?void 0:n.profileType},"User answering name question"),o?o.length>100?(e.logger.warn({userId:s,nameLength:o.length},"User name too long"),yield e.reply(e.t("long_name"),{reply_markup:(0,keyboards_1.nameKeyboard)(e.session)})):(e.logger.info({userId:s,name:o},"User name validated and saved"),e.session.question="text",e.session.activeProfile.name&&(e.session.activeProfile.previousName=e.session.activeProfile.name),e.session.activeProfile.name=o,yield e.reply(e.t("text_question",{profileType:e.session.additionalFormInfo.selectedProfileType}),{reply_markup:(0,keyboards_1.textKeyboard)(e.t,e.session)})):(e.logger.warn({userId:s},"User sent empty name"),yield e.reply(e.t("type_name"),{reply_markup:(0,keyboards_1.nameKeyboard)(e.session)}))}));exports.nameQuestion=nameQuestion;