"use strict";var __awaiter=this&&this.__awaiter||function(e,s,o,i){return new(o||(o=Promise))((function(r,n){function t(e){try{l(i.next(e))}catch(e){n(e)}}function a(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var s;e.done?r(e.value):(s=e.value,s instanceof o?s:new o((function(e){e(s)}))).then(t,a)}l((i=i.apply(e,s||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.changeProfileFromStart=changeProfileFromStart;const keyboards_1=require("../constants/keyboards"),keyboards_2=require("../constants/keyboards"),keyboards_3=require("../constants/keyboards"),client_1=require("@prisma/client"),profilesService_1=require("./db/profilesService"),keyboards_4=require("../constants/keyboards"),gameLink_1=require("./gameLink");function changeProfileFromStart(e){return __awaiter(this,void 0,void 0,(function*(){var s;const o=String(null===(s=e.from)||void 0===s?void 0:s.id),i=e.message.text,r=(0,profilesService_1.getSubtypeLocalizations)(e.t);e.logger.info({userId:o,message:i,profileType:e.session.additionalFormInfo.selectedProfileType,isEditing:e.session.isEditingProfile},"Starting profile change from start"),e.session.step="questions",e.session.additionalFormInfo.selectedProfileType===client_1.ProfileType.SPORT?(e.session.isEditingProfile||(e.session.additionalFormInfo.selectedSubType=r.sport[i],e.logger.info({userId:o,subType:e.session.additionalFormInfo.selectedSubType},"Selected sport subtype")),e.session.question="sport_level",yield e.reply(e.t("sport_level_question"),{reply_markup:(0,keyboards_4.selectSportLevelkeyboard)(e.t)})):e.session.additionalFormInfo.selectedProfileType===client_1.ProfileType.IT?(e.session.isEditingProfile||(e.session.additionalFormInfo.selectedSubType=r.it[i],e.logger.info({userId:o,subType:e.session.additionalFormInfo.selectedSubType},"Selected IT subtype")),e.session.question="it_experience",yield e.reply(e.t("it_experience_question"),{reply_markup:(0,keyboards_3.selectItExperienceKeyboard)(e.t)})):e.session.additionalFormInfo.selectedProfileType===client_1.ProfileType.GAME?(e.session.isEditingProfile||(e.session.additionalFormInfo.selectedSubType=r.game[i],e.logger.info({userId:o,subType:e.session.additionalFormInfo.selectedSubType},"Selected game subtype")),e.session.question="game_account",e.session.additionalFormInfo.selectedSubType&&(yield e.reply(e.t(gameLink_1.gameLocalizationKeys[e.session.additionalFormInfo.selectedSubType]),{reply_markup:(0,keyboards_2.gameAccountKeyboard)(e.t,e.session)}))):e.session.additionalFormInfo.selectedProfileType===client_1.ProfileType.HOBBY?(e.session.additionalFormInfo.selectedSubType=r.hobby[i],e.logger.info({userId:o,subType:e.session.additionalFormInfo.selectedSubType},"Selected hobby subtype"),e.session.question="years",yield e.reply(e.t("years_question"),{reply_markup:(0,keyboards_1.ageKeyboard)(e.session)})):(e.session.question="years",e.logger.info({userId:o,profileType:e.session.additionalFormInfo.selectedProfileType},"Using default years question"),yield e.reply(e.t("years_question"),{reply_markup:(0,keyboards_1.ageKeyboard)(e.session)})),e.logger.info({userId:o,question:e.session.question},"Profile change from start completed")}))}