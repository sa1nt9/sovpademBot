"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function u(e){try{a(o.next(e))}catch(e){n(e)}}function l(e){try{a(o.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.setMutualLike=setMutualLike;const postgres_1=require("../../db/postgres"),logger_1=require("../../logger");function setMutualLike(e,t){return __awaiter(this,void 0,void 0,(function*(){logger_1.logger.info({fromProfileId:e,toProfileId:t},"Setting mutual like");try{const r=yield postgres_1.prisma.profileLike.updateMany({where:{fromProfileId:e,toProfileId:t,liked:!0},data:{isMutual:!0,isMutualAt:new Date}});return logger_1.logger.info({fromProfileId:e,toProfileId:t,updatedCount:r.count},"Mutual like set successfully"),r}catch(r){throw logger_1.logger.error({fromProfileId:e,toProfileId:t,error:r instanceof Error?r.message:"Unknown error"},"Error setting mutual like"),r}}))}